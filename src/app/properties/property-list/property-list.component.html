<!-- property-list.component.html -->
<app-search-property></app-search-property>

<!-- Advanced Search Placeholders (will be implemented later) -->
<div class="container pt-2 pb-2">
  <div class="row adv-btn-row">
    <div class="btn-con">
      <!-- Price Filter (Placeholder - will be PriceRangeComponent) -->
      <div class="d-inline-block dropdown" id="bootstrapfirstdropdown">
        <button type="button" class="btn btn-primary filter-btn dropdown-toggle" data-bs-toggle="dropdown">
          Price
        </button>
        <div class="dropdown-menu">
          <!-- PriceRangeComponent will go here -->
          <div class="text-center p-3">
            <small>Price filter component coming soon</small>
          </div>
        </div>
      </div>

      <!-- Advanced Search (Placeholder) -->
      <div class="d-inline-block">
        <button type="button" class="btn btn-primary filter-btn dropdown-toggle" data-bs-toggle="dropdown">
          Advanced Search &nbsp;
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-sliders" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M11.5 2a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M9.05 3a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0V3zM4.5 7a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M2.05 8a2.5 2.5 0 0 1 4.9 0H16v1H6.95a2.5 2.5 0 0 1-4.9 0H0V8zm9.45 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m-2.45 1a2.5 2.5 0 0 1 4.9 0H16v1h-2.05a2.5 2.5 0 0 1-4.9 0H0v-1z"/>
          </svg>
        </button>
        <div class="dropdown-menu dropdown-menu-center bg-white advance-search-modal">
          <!-- AdvancedSearchComponent will go here -->
          <div class="text-center p-3">
            <small>Advanced search component coming soon</small>
          </div>
        </div>
      </div>

      <!-- Favorites Button -->
      <div class="mr-1 mobile-view">
        <button class="btn heartdivbtn">
          <img class="heartimgclass" title="My Favorites" src="https://destinique.com/assets/svg/icons8heart.png" alt="heart"/>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Results Header -->
<div id="maindiv">
  <div class="row">
    <!-- Left side: Total count and global controls -->
    <div class="col-sm-6 d-flex justify-content-center align-items-center">
      <div class="viewAll">
                <span id="maindivspan">
                    Total Properties - {{paginationInfo.total}}
                </span>

        <div class="form-check expandview-title">
          <input type="checkbox" class="form-check-input" id="more-details"
                 [(ngModel)]="showMoreDetailsGlobal"
                 (change)="onToggleGlobalMoreDetails()">
          <label class="form-check-label" for="more-details">More Details</label>
        </div>

        <!-- Action buttons (optional) -->
        <div class="buttons">
          <button class="resetbtn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
              <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
              <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
            </svg>
            &nbsp;
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check-square" viewBox="0 0 16 16">
              <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z"/>
              <path d="M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Right side: Sort, page size, and list ID search -->
    <div class="col-sm-6 d-flex ar justify-content-center align-items-center">
      <div id="filter-properties">
        <!-- Page Size Component -->
        <span class="mr-1">
                    <app-page-size
                      [pageSizeOptions]="pageSizeOptions"
                      [selectedPageSize]="paginationInfo.pageSize"
                      (pageSizeChange)="onPageSizeChange($event)">
                    </app-page-size>
                </span>

        <!-- Sort Component -->
        <span class="mr-1">
                    <app-sort-dropdown
                      [sortOptions]="sortOptions"
                      [selectedSort]="searchState.currentState.sortBy"
                      (sortChange)="onSortChange($event)">
                    </app-sort-dropdown>
                </span>

        <!-- List ID Search Component -->
        <app-list-id-search (searchComplete)="onListIdSearchComplete($event)"></app-list-id-search>
      </div>
    </div>
  </div>
</div>

<!-- Properties Grid -->
<div class="container-fluid">
  <!-- Loading Indicator -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading properties...</p>
  </div>

  <!-- No Results -->
  <div *ngIf="!isLoading && properties.length === 0" class="text-center py-5">
    <h4>No properties found</h4>
    <p>Try adjusting your search filters</p>
  </div>

  <!-- Properties Grid -->
  <div *ngIf="!isLoading && properties.length > 0" class="row view-grid">
    <div *ngFor="let property of properties"
         class="col-12 col-md-6 col-lg-4 col-xl-4 properties">
      <app-property-card
        [property]="property"
        [isExpanded]="expandedPropertyId === property.list_id"
        [showMoreDetailsGlobal]="showMoreDetailsGlobal"
        (toggleExpand)="onToggleExpand($event)">
      </app-property-card>
    </div>
  </div>

  <!-- Pagination -->
  <app-pagination
    *ngIf="!isLoading && properties.length > 0 && paginationInfo.totalPages > 1"
    [currentPage]="paginationInfo.page"
    [totalPages]="paginationInfo.totalPages"
    [pageSize]="paginationInfo.pageSize"
    [totalItems]="paginationInfo.total"
    (pageChange)="onPageChange($event)">
  </app-pagination>
</div>
